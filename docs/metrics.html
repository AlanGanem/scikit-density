---

title: Dev comments


keywords: fastai
sidebar: home_sidebar



nb_path: "notebooks\04_metrics.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: notebooks\04_metrics.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>[X] TODO: make entropy estimator with KDE</li>
<li>[X] TODO: make quantile func</li>
<li>[ ] TODO: make Gaussian Mixture entropy estimation</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Test-data">Test data<a class="anchor-link" href="#Test-data"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We are going to test utils using the following data:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_dists</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">y_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

<span class="n">y_dists_1d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y_true_1d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="kde_entropy"><a href="/scikit_density/metrics.html#kde_entropy"><code>kde_entropy</code></a><a class="anchor-link" href="#kde_entropy"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="kde_entropy" class="doc_header"><code>kde_entropy</code><a href="https://github.com/alanmottaganem/scikit_density/tree/master/scikit_density/metrics.py#L23" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>kde_entropy</code>(<strong><code>data</code></strong>, <strong><code>sample_size</code></strong>=<em><code>10000</code></em>, <strong><code>bw</code></strong>=<em><code>'ISJ'</code></em>)</p>
</blockquote>
<p>Calculates the entropy of multiple distributions
input should be of shape (n_distributions, n_sample_per_distribution, n_dims_in_distribtuion)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="/scikit_density/metrics.html#kde_entropy"><code>kde_entropy</code></a> estimates a distribution of an aribtrary dimension random variable using kernel density estimation and calculates its entropy</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kde_entropy</span><span class="p">(</span><span class="n">y_dists</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([4.19584855, 4.43819543, 4.39191813, 4.44084663, 4.2976626 ,
       4.43929067, 4.24074559, 4.24561533, 4.30936576, 4.22102025])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>it
<span class="n">kde_entropy</span><span class="p">(</span><span class="n">y_dists</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>303 ms ± 20 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="quantile"><a href="/scikit_density/metrics.html#quantile"><code>quantile</code></a><a class="anchor-link" href="#quantile"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="quantile" class="doc_header"><code>quantile</code><a href="https://github.com/alanmottaganem/scikit_density/tree/master/scikit_density/metrics.py#L32" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>quantile</code>(<strong><code>y_true</code></strong>, <strong><code>pred_dist</code></strong>)</p>
</blockquote>
<p>checks in which quantile lies y_true, given the predicted distribution</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="/scikit_density/metrics.html#quantile"><code>quantile</code></a> checks the quantile of each dimension of an observation <code>y_true</code> given an empirical distribution <code>y_dists</code></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">quantile</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_dists</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[[0.725, 0.015],
        [0.945, 0.695],
        [0.54 , 0.17 ],
        [0.05 , 0.34 ],
        [0.77 , 0.11 ],
        [0.625, 0.705],
        [0.925, 0.24 ],
        [0.705, 0.805],
        [0.99 , 0.67 ],
        [0.18 , 0.655]]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>it
<span class="n">quantile</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_dists</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>150 µs ± 3.09 µs per loop (mean ± std. dev. of 7 runs, 10000 loops each)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="quantile_sklearn"><a href="/scikit_density/metrics.html#quantile_sklearn"><code>quantile_sklearn</code></a><a class="anchor-link" href="#quantile_sklearn"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="quantile_sklearn" class="doc_header"><code>quantile_sklearn</code><a href="https://github.com/alanmottaganem/scikit_density/tree/master/scikit_density/metrics.py#L41" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>quantile_sklearn</code>(<strong><code>y_true</code></strong>, <strong><code>pred_dist</code></strong>)</p>
</blockquote>
<p>checks in which quantile lies y_true, given the predicted distribution, using skleaerns QuantileTransformer</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="/scikit_density/metrics.html#quantile_sklearn"><code>quantile_sklearn</code></a> does the same as <a href="/scikit_density/metrics.html#quantile"><code>quantile</code></a>, but with <code>sklearn</code>s <code>QuantileTransformer</code></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">quantile_sklearn</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_dists</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[[0.7278008 , 0.01447408]],

       [[0.9496229 , 0.69639994]],

       [[0.53860615, 0.1690896 ]],

       [[0.04560922, 0.34077751]],

       [[0.76982081, 0.10779354]],

       [[0.62630501, 0.70365157]],

       [[0.92464003, 0.24046056]],

       [[0.70444373, 0.80482178]],

       [[0.99463003, 0.66871387]],

       [[0.17602332, 0.65460287]]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>it
<span class="n">quantile_sklearn</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_dists</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>5.43 ms ± 85.1 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="theoretical_entropy"><a href="/scikit_density/metrics.html#theoretical_entropy"><code>theoretical_entropy</code></a><a class="anchor-link" href="#theoretical_entropy"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="theoretical_entropy" class="doc_header"><code>theoretical_entropy</code><a href="https://github.com/alanmottaganem/scikit_density/tree/master/scikit_density/metrics.py#L49" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>theoretical_entropy</code>(<strong><code>data</code></strong>, <strong><code>dist</code></strong>=<em><code>'norm'</code></em>)</p>
</blockquote>
<p>returns the entropy of the maximum likelihood estiation of <code>dist</code> given <code>data</code>
dist should be one dimensional for cases when <code>dist</code> != 'kde'</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="/scikit_density/metrics.html#theoretical_entropy"><code>theoretical_entropy</code></a> returns the entropy of the maximum likelihood estiation of <code>dist</code> given <code>data</code>
    dist should be one dimensional for cases when <code>dist</code> != 'kde'</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">theoretical_entropy</span><span class="p">(</span><span class="n">y_dists_1d</span><span class="p">,</span> <span class="n">dist</span> <span class="o">=</span> <span class="s1">&#39;norm&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([1.30701586, 1.51849768, 1.49686731, 1.49346887, 1.33472044,
       1.33898642, 1.3316598 , 1.44444205, 1.43230334, 1.49410763])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>it
<span class="n">theoretical_entropy</span><span class="p">(</span><span class="n">y_dists_1d</span><span class="p">,</span> <span class="n">dist</span> <span class="o">=</span> <span class="s1">&#39;norm&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>6.9 ms ± 187 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="variance"><code>variance</code><a class="anchor-link" href="#variance"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="marginal_variance" class="doc_header"><code>marginal_variance</code><a href="https://github.com/alanmottaganem/scikit_density/tree/master/scikit_density/metrics.py#L58" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>marginal_variance</code>(<strong><code>data</code></strong>)</p>
</blockquote>
<p>Calculates the variance for each dimension (marginal) of multiple distributions
input should be of shape (n_distributions, n_sample_per_distribution, n_dims_in_distribtuion)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="/scikit_density/metrics.html#marginal_variance"><code>marginal_variance</code></a> Calculates the variance for each dimension (marginal) of multiple distributions
    input should be of shape (n_distributions, n_sample_per_distribution, n_dims_in_distribtuion)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">marginal_variance</span><span class="p">(</span><span class="n">y_dists</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[1.07997805, 0.97298247],
       [1.08478207, 0.80053107],
       [1.04474869, 0.90155785],
       [1.06384356, 0.96478837],
       [1.05452459, 0.91047929],
       [0.90663148, 1.10136982],
       [1.01474701, 0.95389312],
       [0.86083731, 0.94958826],
       [0.96977624, 1.11934001],
       [0.92623992, 1.04994311]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="covariance_matrix"><a href="/scikit_density/metrics.html#covariance_matrix"><code>covariance_matrix</code></a><a class="anchor-link" href="#covariance_matrix"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="covariance_matrix" class="doc_header"><code>covariance_matrix</code><a href="https://github.com/alanmottaganem/scikit_density/tree/master/scikit_density/metrics.py#L67" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>covariance_matrix</code>(<strong><code>data</code></strong>)</p>
</blockquote>
<p>Calculates the variance for each dimension (marginal) of multiple distributions
input should be of shape (n_distributions, n_sample_per_distribution, n_dims_in_distribtuion)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="bimodal_split"><a href="/scikit_density/metrics.html#bimodal_split"><code>bimodal_split</code></a><a class="anchor-link" href="#bimodal_split"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bimodal_split" class="doc_header"><code>bimodal_split</code><a href="https://github.com/alanmottaganem/scikit_density/tree/master/scikit_density/metrics.py#L75" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bimodal_split</code>(<strong><code>data</code></strong>, <strong><code>filter_size</code></strong>=<em><code>3</code></em>, <strong><code>lb</code></strong>=<em><code>0.1</code></em>, <strong><code>ub</code></strong>=<em><code>0.9</code></em>)</p>
</blockquote>
<p>reutrns siplitting point of single distribution in two according to the highest value of the derivative of cpdf</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="/scikit_density/metrics.html#bimodal_split"><code>bimodal_split</code></a> reutrns siplitting point of single distribution in two according to the highest value of the derivative of cpdf</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bimodal_split</span><span class="p">(</span><span class="n">y_dists</span><span class="p">[</span><span class="mi">0</span><span class="p">,:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">filter_size</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">lb</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span><span class="n">ub</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>-1.4383953140490906</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>it
<span class="n">bimodal_split</span><span class="p">(</span><span class="n">y_dists</span><span class="p">[</span><span class="mi">0</span><span class="p">,:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">filter_size</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">lb</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span><span class="n">ub</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>22.4 µs ± 667 ns per loop (mean ± std. dev. of 7 runs, 10000 loops each)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="mad"><a href="/scikit_density/metrics.html#mad"><code>mad</code></a><a class="anchor-link" href="#mad"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="mad" class="doc_header"><code>mad</code><a href="https://github.com/alanmottaganem/scikit_density/tree/master/scikit_density/metrics.py#L92" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>mad</code>(<strong><code>data</code></strong>)</p>
</blockquote>
<p>calculates mean average deviance (a robust version of standard deviation)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="bimodal_var"><a href="/scikit_density/metrics.html#bimodal_var"><code>bimodal_var</code></a><a class="anchor-link" href="#bimodal_var"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bimodal_var" class="doc_header"><code>bimodal_var</code><a href="https://github.com/alanmottaganem/scikit_density/tree/master/scikit_density/metrics.py#L100" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bimodal_var</code>(<strong><code>data</code></strong>, <strong><code>filter_size</code></strong>=<em><code>0.05</code></em>, <strong><code>lb</code></strong>=<em><code>0.1</code></em>, <strong><code>ub</code></strong>=<em><code>0.9</code></em>)</p>
</blockquote>
<p>returns weighted marginal variance of splitted data in two according to the highest value of the derivative of cpdf
returns a variance array of shape (n_dists, n_dims)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="/scikit_density/metrics.html#bimodal_var"><code>bimodal_var</code></a> returns weighted variance of splitted data in two according to the highest value of the derivative of cpdf
    returns a variance array of shape (n_dists, n_dims)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bimodal_var</span><span class="p">(</span><span class="n">y_dists</span><span class="p">,</span> <span class="n">filter_size</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">lb</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span><span class="n">ub</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[0.34154432, 0.37242164],
       [0.30069423, 0.37842003],
       [0.33386546, 0.31060919],
       [0.31703943, 0.36906463],
       [0.32809221, 0.40863546],
       [0.38355878, 0.32805146],
       [0.30257438, 0.40595029],
       [0.42650975, 0.45140764],
       [0.28671314, 0.41607512],
       [0.39736197, 0.31993504]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>it
<span class="n">bimodal_var</span><span class="p">(</span><span class="n">y_dists</span><span class="p">,</span> <span class="n">filter_size</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">lb</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span><span class="n">ub</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1.31 ms ± 20.6 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="gaussian_distance_entropy"><a href="/scikit_density/metrics.html#gaussian_distance_entropy"><code>gaussian_distance_entropy</code></a><a class="anchor-link" href="#gaussian_distance_entropy"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="gaussian_distance_entropy" class="doc_header"><code>gaussian_distance_entropy</code><a href="https://github.com/alanmottaganem/scikit_density/tree/master/scikit_density/metrics.py#L120" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>gaussian_distance_entropy</code>(<strong><code>data</code></strong>)</p>
</blockquote>
<p>calculates the entropy of the distribution of distances from centroid of points in dist, assuming normal distribution</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="expected_distance_gaussian_likelihood"><a href="/scikit_density/metrics.html#expected_distance_gaussian_likelihood"><code>expected_distance_gaussian_likelihood</code></a><a class="anchor-link" href="#expected_distance_gaussian_likelihood"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="expected_distance_gaussian_likelihood" class="doc_header"><code>expected_distance_gaussian_likelihood</code><a href="https://github.com/alanmottaganem/scikit_density/tree/master/scikit_density/metrics.py#L127" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>expected_distance_gaussian_likelihood</code>(<strong><code>data</code></strong>)</p>
</blockquote>
<p>calculates the expected likelihood of the distances from centroid of samples in distributions in dist
input should be of shape (n_distributions, n_sample_per_distribution, n_dims_in_distribtuion)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="distance_gaussian_likelihood"><a href="/scikit_density/metrics.html#distance_gaussian_likelihood"><code>distance_gaussian_likelihood</code></a><a class="anchor-link" href="#distance_gaussian_likelihood"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="distance_gaussian_likelihood" class="doc_header"><code>distance_gaussian_likelihood</code><a href="https://github.com/alanmottaganem/scikit_density/tree/master/scikit_density/metrics.py#L136" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>distance_gaussian_likelihood</code>(<strong><code>data</code></strong>)</p>
</blockquote>
<p>calculates the expected likelihood of the distances from the centroid of samples in dist</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="make_outlier_filter"><a href="/scikit_density/metrics.html#make_outlier_filter"><code>make_outlier_filter</code></a><a class="anchor-link" href="#make_outlier_filter"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="make_outlier_filter" class="doc_header"><code>make_outlier_filter</code><a href="https://github.com/alanmottaganem/scikit_density/tree/master/scikit_density/metrics.py#L149" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>make_outlier_filter</code>(<strong><code>data</code></strong>, <strong><code>lb</code></strong>=<em><code>25</code></em>, <strong><code>ub</code></strong>=<em><code>75</code></em>, <strong><code>c</code></strong>=<em><code>1</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="filter_borders"><a href="/scikit_density/metrics.html#filter_borders"><code>filter_borders</code></a><a class="anchor-link" href="#filter_borders"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="filter_borders" class="doc_header"><code>filter_borders</code><a href="https://github.com/alanmottaganem/scikit_density/tree/master/scikit_density/metrics.py#L161" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>filter_borders</code>(<strong><code>data</code></strong>, <strong><code>lb</code></strong>=<em><code>0.05</code></em>, <strong><code>ub</code></strong>=<em><code>0.95</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

